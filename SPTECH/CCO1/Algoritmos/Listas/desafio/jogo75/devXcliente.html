<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sete e Meio</title>
    <link rel="stylesheet" href="style7.css">
</head>
<body>
    
    <div id="tela1" class="tela1">
        <div class="inicio">
            <h1>Dev x Cliente <br>
                (Sete e Meio)</h1>
            <button onclick="sortear()">Iniciar Jogo</button>
        </div>
    </div>

    <div id="tela2" style="display: none;" class="tela2">
        <div class="ctd">
            <div id="div_mensagem" class="msg"></div>
            <div class="bts">
                <button onclick="sortear()" id="botao_carta">Adicionar Requisito</button>
                <button onclick="sortear(2)" id="botao_passar">Entregar Projeto</button>
            </div>
        </div>
    </div>

    
</body>
</html>

<script>

    const baralho = [{num: 'A', copas: 0, espadas: 0, ouros: 0, paus: 0},
                     {num: '2', copas: 0, espadas: 0, ouros: 0, paus: 0},
                     {num: '3', copas: 0, espadas: 0, ouros: 0, paus: 0},
                     {num: '4', copas: 0, espadas: 0, ouros: 0, paus: 0},
                     {num: '5', copas: 0, espadas: 0, ouros: 0, paus: 0},
                     {num: '6', copas: 0, espadas: 0, ouros: 0, paus: 0},
                     {num: '7', copas: 0, espadas: 0, ouros: 0, paus: 0},
                     {num: 'Val', copas: 0, espadas: 0, ouros: 0, paus: 0},
                     {num: 'Rai', copas: 0, espadas: 0, ouros: 0, paus: 0},
                     {num: 'Rei', copas: 0, espadas: 0, ouros: 0, paus: 0}];

    var minC = 1;
    var maxC = 10;

    var minN = 1;
    var maxN = 4;

    let cartaNum = ''
    let cartaNap = ''

    let cont = 0;

    let pontuacaoJg = 0
    let pontuacaoMs = 0

    let vez = 1

    function sortear(param) {
        if (cont == 0){
            tela1.style.display = 'none'
            tela2.style.display = 'block'

            cont++
            div_mensagem.innerHTML = `Desenvolvedor: <br> <br>`
        }

        if (param == 2){
            vez = 2
        }

        var numC = Math.random() * (maxC - minC) + minC; // * intervalo + min;
        var naipe = Math.random() * (maxN - minN) + minN; // * intervalo + min; 
        
        cartaNum = numC.toFixed()
        cartaNap = naipe.toFixed()

        if(cartaNap == 1){
            cartaNap = 'copas'
        } else if(cartaNap == 2){
            cartaNap = 'espadas'
        } else if(cartaNap == 3){
            cartaNap = 'ouros'
        } else if(cartaNap == 4){
            cartaNap = 'paus'
        } 

        if(cartaNum == 8){
            cartaNum = 'Val'
        } else if (cartaNum == 9){
            cartaNum = 'Rai'
        } else if (cartaNum == 10){
            cartaNum = 'Rei'
        } else if (cartaNum == 1){
            cartaNum = 'A'
        }
        
        procurar();
    }


     function procurar() {
        for(var i = 0; i < baralho.length; i++){
            if(baralho[i].num == cartaNum){
                if (cartaNap == 'copas' ){
                    if(baralho[i].copas == 0){
                        baralho[i].copas = 1
                        jogar()
                        break;
                    } else {
                        sortear()
                        break;
                    }
                } else if (cartaNap == 'espadas' ){
                    if(baralho[i].espadas == 0){
                        baralho[i].espadas = 1
                        jogar()
                        break;
                    } else {
                        sortear()
                        break;
                    }
                } else if (cartaNap == 'ouros' ){
                    if(baralho[i].ouros == 0){
                        baralho[i].ouros = 1
                        jogar()
                        break;
                    } else {
                        sortear()
                        break;
                    }
                } else if (cartaNap == 'paus' ){
                    if(baralho[i].paus == 0){
                        baralho[i].paus = 1
                        jogar()
                        break;
                    } else {
                        sortear()
                        break;
                    }
                }
            }

        }
     }

     var req = ""
     var contPlay = 0;

    function jogar(){
        if (cartaNum == 'A'){
            cartaNum = 'Ás'
            pont = 1
            if (vez == 1) {
                pontuacaoJg += 1 
                req = "Requisito IMPORTANTE Adicionado!"
            }
            if (vez == 2) {
                pontuacaoMs += 1 
                req = "Requisito IMPORTANTE Encontrado!"
            }

        } else if (cartaNum == '2'){
            pont = 2
            if (vez == 1) {
                pontuacaoJg += 2
                req = "Requisito IMPORTANTE Adicionado!"
            }
            if (vez == 2) {
                pontuacaoMs += 2
                req = "Requisito IMPORTANTE Encontrado!"
            }

        } else if (cartaNum == '3'){
            pont = 3
            if (vez == 1) {
                pontuacaoJg += 3
                req = "Requisito IMPORTANTE Adicionado!"
            }
            if (vez == 2) {
                pontuacaoMs += 3
                req = "Requisito IMPORTANTE Encontrado!"
            }

        } else if (cartaNum == '4'){
            pont = 4
            if (vez == 1){
                pontuacaoJg += 4
                req = "Requisito IMPORTANTE Adicionado!"
            }
            if (vez == 2) {
                pontuacaoMs += 4
                req = "Requisito IMPORTANTE Encontrado!"
            }

        } else if (cartaNum == '5'){
            pont = 5
            if (vez == 1) {
                pontuacaoJg += 5
                req = "Requisito IMPORTANTE Adicionado!"
            }
            if (vez == 2) {
                pontuacaoMs += 5
                req = "Requisito IMPORTANTE Encontrado!"
            }

        } else if (cartaNum == '6'){
            pont = 6
            if (vez == 1) {
                pontuacaoJg += 6
                req = "Requisito IMPORTANTE Adicionado!"
            }
            if (vez == 2) {
                pontuacaoMs += 6
                req = "Requisito IMPORTANTE Encontrado!"
            }

        } else if (cartaNum == '7'){
            pont = 7
            if (vez == 1) {
                pontuacaoJg += 7
                req = "Requisito IMPORTANTE Adicionado!"
            }
            if (vez == 2) {
                pontuacaoMs += 7
                req = "Requisito IMPORTANTE Encontrado!"
            }

        } else {
            pont = 0.5
            if (vez == 1) {
                pontuacaoJg += 0.5
                req = "Requisito DESEJAVEL Adicionado!"
            }
            if (vez == 2) {
                pontuacaoMs += 0.5
                req = "Requisito DESEJAVEL Encontrado!"
            }

        }

        if (contPlay == 0 && vez == 2){
            div_mensagem.innerHTML += '<br> <br> Cliente: <br>'
            contPlay++
        }

        if (vez == 1){
            div_mensagem.innerHTML += `${req} (${pont} pontos) <br> [${cartaNum} ${cartaNap}] <br> Progressão Projeto: ${pontuacaoJg} <br> `
        }

        if (vez == 2){
            div_mensagem.innerHTML += `${req} (${pont} pontos) <br> [${cartaNum} ${cartaNap}] <br> Progressão Pedido: ${pontuacaoMs} <br> `
        }

        if( vez == 1 && pontuacaoJg == 7.5){
            div_mensagem.innerHTML += '<br> SETE E MEIO! DEV fez um projeto PERFEITO!'
            botao_carta.disabled = true;
            botao_passar.disabled = true;
        } 
        
        else if (pontuacaoJg > 7.5){
            div_mensagem.innerHTML += `<br> Dev estorou o orçamento! Foi demitido`
            botao_carta.disabled = true;
            botao_passar.disabled = true;
        }
        
        else if( vez == 2 && pontuacaoMs == 7.5){
            div_mensagem.innerHTML += '<br> O cliente analisou PERFEITAMENTE o projeto e achou falhas! Você foi demitido'
            botao_carta.disabled = true;
            botao_passar.disabled = true;

        } 
        else if (pontuacaoMs > 7.5){
            div_mensagem.innerHTML += `<br> Cliente pediu coisas fora do escopo! Dev ganhou`
            botao_carta.disabled = true;
            botao_passar.disabled = true;
        }

        else if( vez == 2 && pontuacaoJg >= pontuacaoMs){
            sortear()
        } else if (vez == 2 && pontuacaoJg < pontuacaoMs){
                div_mensagem.innerHTML += `<br> Cliente achou coisas faltando no projeto! Você perdeu! <br> [pontos cliente: ${pontuacaoMs}]`
                botao_carta.disabled = true;
                botao_passar.disabled = true;
            
        } 
    }
</script>